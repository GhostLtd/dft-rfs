{% extends 'domestic_survey/form-base.html.twig' %}

{% block oneThirdColumnContent -%}
    <h2 class="govuk-heading-m">
    {%- if subject.id is null -%}
        Adding a stage
    {%- else -%}
        Editing stage {{ subject.number }}
    {%- endif -%}
    on day {{ subject.day.number }} ({{ subject.day.response.survey.surveyPeriodStartModifiedBy('+' ~ (subject.day.number-1) ~ ' day') | date('F j, Y') }})</h2>

    {% if subject.originLocation and subject.destinationLocation %}
        <p class="govuk-body">{{ subject.originLocation }} to {{ subject.destinationLocation }}</p>
    {% else %}
        {% set stops = subject.day.stops.values %}{# .values gives a 0-indexed array #}
        {% if stops | length > 1 %}
            {% set previousStage = stops[stops | length - 2] %}
            <h3 class="govuk-heading-s govuk-!-margin-bottom-1">Previous stage on this day</h3>
            <p class="govuk-body">{{ previousStage.originLocation }} to {{ previousStage.destinationLocation }}</p>
        {% else %}
            <p class="govuk-body">This is the first stage of the day</p>
        {% endif %}
    {% endif %}

    {%- block wizardContext %}
    {% endblock %}
    <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible">
    {{ parent() }}
{% endblock %}
