<?php


namespace App\Tests\Pentest;


use Symfony\Bundle\FrameworkBundle\Test\WebTestCase;

class SecureCookieTest extends WebTestCase
{
    public function testCheckFrontendCookieIsSecure()
    {
        $client = static::createClient();
        $client->request('GET', 'http://frontend.rfs.test/login');
        self::assertResponseHeaderSame('location', 'https://frontend.rfs.test/login');

        $client->request('GET', 'https://frontend.rfs.test/login');
        self::assertBrowserHasCookie('MOCKSESSID');
        self::assertTrue($client->getCookieJar()->get('MOCKSESSID')->isSecure());
    }
}